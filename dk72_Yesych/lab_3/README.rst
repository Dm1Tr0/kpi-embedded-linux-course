=================================================
**Лабораторна робота №3 засоби відкладеної роботи: таймер високої точності**
=================================================

Завдання
---------------------------------------------------------

* ознайомитись hrtimer
* на основі модулю з минулої лабораторної роботи створити модуль що буде мати такий самий
функціонал але замість звичайного таймеру будемо використовувати таймер високої роздільної здатності

Хід роботи
----------------------------------------------------------

**Написання модуля ядра**
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Згідно з отриманим завданням було створено модуль ядра що є переробкою модуля ядра з минулої лабораторної роботи тільки замість використаного в минулій роботі Timeout timer було використано HR timer.

у зв'язку з завданням потрібно використовувати HR timer по цій причині було створено змінну  ktime для виставлення значення expire, та звичайно замінено оброрбник переривань таймеру обробник перериванть HR таймеру повинен повертати змінну типу (enum) HRTIMER_RESTART або HRTIMER_NORESTART
при поверненні значення HRTIMER_RESTART таймер запускається повторно після завершення роботи обробника в іншому випадку таймер повторно не активується. Для зазначеня часу відпрацювання таймеру була використана функція
``hrtimer_forward`` зартимка задається за допомогую типа данних ktime_t за для переводу секунд до цього типу данних використовуємо функцію ktime_set(). Та також видалення HR таймеру відбувається за допомогою функції ``hrtimer_cancel``

Тести та демонстрація hrtimer в порівняні Timeout timer:

.. code-block:: bash

 Timeout_timer:
 / # rmmod mymod
 [  134.912584] exit>> tim_cnt 10
 [  134.912584] exit>> countrer number 0 has the 4294770217 jiffies val
 [  134.913821] exit>> countrer number 1 has the 4294770223 jiffies val
 [  134.914597] exit>> countrer number 2 has the 4294770232 jiffies val
 [  134.915331] exit>> countrer number 3 has the 4294770238 jiffies val
 [  134.916079] exit>> countrer number 4 has the 4294770245 jiffies val
 [  134.916778] exit>> countrer number 5 has the 4294770251 jiffies val
 [  134.917492] exit>> countrer number 6 has the 4294770258 jiffies val
 [  134.918191] exit>> countrer number 7 has the 4294770264 jiffies val
 [  134.918922] exit>> countrer number 8 has the 4294770270 jiffies val
 [  134.919457] exit>> countrer number 9 has the 4294770277 jiffies val
 [  134.920226] exit>> dealoc: array is deallocated
 [  134.920925] exit>> god save the Kernel!; jiffies = 4294802249
 hrtimer:
 /mnt # rmmod mymod
 [23248.313059] exit>> tim_cnt: 10
 [23248.313142] exit>> countrer number 0 has the 4317908065 jiffies val
 [23248.313660] exit>> countrer number 1 has the 4317908070 jiffies val
 [23248.315108] exit>> countrer number 2 has the 4317908075 jiffies val
 [23248.316020] exit>> countrer number 3 has the 4317908080 jiffies val
 [23248.319176] exit>> countrer number 4 has the 4317908085 jiffies val
 [23248.320042] exit>> countrer number 5 has the 4317908090 jiffies val
 [23248.320859] exit>> countrer number 6 has the 4317908096 jiffies val
 [23248.321682] exit>> countrer number 7 has the 4317908100 jiffies val
 [23248.322340] exit>> countrer number 8 has the 4317908105 jiffies val
 [23248.323439] exit>> countrer number 9 has the 4317908110 jiffies val
 [23248.324355] exit>> dealoc: array is deallocated
 [23248.325274] exit>> god save the Kernel!; jiffies = 4317915648
Висновки
------------
в результаті роботи було перероблено свій модуль ядра з лабораторнрої роботи №2 заміною таймеру на hr таймер при написанні модуля не виникло проблем, а от з пошуком
літератури не складної для розуміння виникли деякі труднощі тому потрібно було витратити додатковий час на заповнення деяких прогалин в розумінні деяких аспектів роботи таймерів в цілому
щоб нормально розібратись з роботою hr таймеру. З особливестей які одразу видно таймер високої роздільної здатності має набагато більшу точність, це зумовлено тим що роздільна здатність hr таймерів mk-n секунди а в  timer wheel
міньімальноможлива роздільна здатність- 3ms така велика різниця в точності викликана призначенням цих таймерів timer wheel використовуються на приклад для визначення таймаутів очікування а таймери високої роздільної здатності використовують наприклад для генерації ШІМ сигналу. Потрібно зазначити що незважаючи на точність hr таймерів іноді виникали похибки в 1-2 jiffies.
