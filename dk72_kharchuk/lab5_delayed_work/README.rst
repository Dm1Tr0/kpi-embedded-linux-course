=============================================
Лабораторна робота №5
=============================================


**Завдання:**
~~~~~~~~~~~~~
   
— Написать модуль ядра, который принимает аргументы th_val, wrk_val и jffdelay, реализует два потока и ворк (в дефолтном work queue), а также таймер (на базе timer wheel)
— Запускает таймер и ворк
— При срабатывании таймера проверяет текущее значение jiffies, если оно кратно th_val – остановить первый поток; иначе – таймер перезапускается через jffdelay jiffies
— Внутри ворка проверяет текущее значение jiffies, если оно кратно wrk_val – остановить второй поток; иначе – ворк должен уснуть на jffdelay jiffies и перезапустить себя.
— Проверить работу. Для th_val и wrk_val желательно выбирать простые числа
— Добавить два связных списка, в которые аллоцировать и добавлять элементы со значениями jiffies которые не привели к завершению первого и второго потоков соответственно. Получается связь "таймер – 1й список – 1й поток" и  "ворк – 2й список – 2й поток"
— При выходе из потока распечатать список
— Внутри ворка и таймера использовать правильные аллокации для новых элементов списка, правильную синхронизацию доступа к списку
— Предусмотреть, что пользователь может выгрузить модуль досрочно
      

**Хід роботи:**
~~~~~~~~~~~~~~~
Код написано на базі лекційного матеріалу та четвортої лабораторної. Намагався зупиняти потоки через completition але кожен раз ловив краш, вирішив зробити зупинку тредів через прапорці, відпрацьовує все коректно. Отримані данні писались в список

Тест модуля:

.. code-block:: bash

 insmod /mnt/khmod_wrk.ko th_val=2 wrk_val=2 jffdelay=10000
 [    9.086850] khmod_wrk: loading out-of-tree module taints kernel.
 [    9.105253] khmod_wrk: Module started
 [    9.107228] process [94] is running
 [    9.113675] thread_func_wrk finished
 [    9.114593] process [95] is running
 [    9.115665] tim time = 4294675340
 / # [    9.117047] insmod (93) used greatest stack depth: 13720 bytes left
 [   19.410808] thread_func_tim   finished
 [   19.411274] tim time = 4294676425


Висновки
~~~~~~~~
Було зібрано та протестовано власний модуль ядра. Під час виконання, виникли проблеми при завершені потоків, які виправив використавши прапорці
